1
00:00:00,011 --> 00:00:04,466
Okay, so we have populated the newsletter stories,

2
00:00:04,467 --> 00:00:07,623
uhm, we now need to,

3
00:00:09,443 --> 00:00:14,012
yeah, uh, I'll go through the images flow next because that's the next step

4
00:00:14,013 --> 00:00:19,081
in this process, uh, Images flow is contained

5
00:00:19,082 --> 00:00:22,124
in PivotMedia.ai decoration,

6
00:00:22,125 --> 00:00:24,815
so it's contained in the same flow as these other decoration steps,

7
00:00:24,816 --> 00:00:26,873
uhm, I think it's,

8
00:00:26,874 --> 00:00:30,738
yeah, every five minutes is ridiculous.

9
00:00:31,173 --> 00:00:37,875
The reason I changed this to five minutes actually is because the,

10
00:00:39,375 --> 00:00:41,990
I'll just start going through the flow and get to that.

11
00:00:42,274 --> 00:00:44,562
So, this pulls needs images,

12
00:00:44,563 --> 00:00:48,011
so this, you know, we're now looking at, uh, images.

13
00:00:48,012 --> 00:00:52,814
Every one of these needs an image, and I think that that is inefficient.

14
00:00:52,907 --> 00:00:56,325
It's also more robust. So all of these stories,

15
00:00:56,326 --> 00:00:58,389
there are hundreds and hundreds of stories in here.

16
00:00:58,834 --> 00:01:01,555
What is there? Yeah, there's a lot of stories here.

17
00:01:01,797 --> 00:01:04,016
I think we probably should move.

18
00:01:04,017 --> 00:01:07,220
The, the reason I did it like this and the reason that,

19
00:01:08,156 --> 00:01:11,350
the reason that we have images in this step as opposed to after an

20
00:01:11,351 --> 00:01:13,780
article has been selected for publication, you know,

21
00:01:13,781 --> 00:01:17,756
we have, there's 1,500 stories here and only maybe a hundred over this time

22
00:01:17,757 --> 00:01:21,761
period have been selected for publication.

23
00:01:21,980 --> 00:01:24,010
The rest will, uh, either get,

24
00:01:24,165 --> 00:01:26,700
you know, published in the future or not at all,

25
00:01:26,701 --> 00:01:30,097
depending on how fresh the news is. Most of them will ne-,

26
00:01:30,156 --> 00:01:32,336
most of the stories in here will never get published.

27
00:01:33,034 --> 00:01:36,011
We still create an image for every single one because,

28
00:01:36,012 --> 00:01:38,638
sometimes the image flow fails.

29
00:01:38,639 --> 00:01:42,151
There's a lot of different reasons that the image flow can fail.

30
00:01:48,131 --> 00:01:50,262
Um, uh, sensitive words, get like articles about AI, um, p********** being created.

31
00:01:50,263 --> 00:01:54,473
Like Gemini, neither Gemini nor OpenAI will process that and it will spit out

32
00:01:54,474 --> 00:01:56,584
an error. And when it does that,

33
00:01:56,585 --> 00:02:01,441
even if it retries on fail, it'll just retry the same story.

34
00:02:01,672 --> 00:02:04,536
And if it fails, uh,

35
00:02:04,546 --> 00:02:08,229
if we have this step, and it takes a little while to create these

36
00:02:08,230 --> 00:02:11,055
images. It takes maybe 30 seconds per,

37
00:02:11,799 --> 00:02:16,492
for the, maybe 45 seconds for the entire flow to complete once.

38
00:02:16,617 --> 00:02:18,986
So for one image, we need 45 seconds.

39
00:02:19,367 --> 00:02:24,016
And if we put this flow later on in the steps,

40
00:02:24,017 --> 00:02:27,304
so if we select the stories, there's like a later,

41
00:02:27,305 --> 00:02:30,783
uh, it's called, uh, assemble issues and stories,

42
00:02:30,883 --> 00:02:35,480
this flow determines what articles actually finally make it into the newsletter

43
00:02:35,481 --> 00:02:40,011
from this pool. If we run this step and

44
00:02:40,012 --> 00:02:43,710
then after that, so we, this step has to run after all the news

45
00:02:43,711 --> 00:02:46,480
for the day has come in. So, like, the ingestion flows run,

46
00:02:46,737 --> 00:02:51,235
all the news has come in, uh, we're ready to actually like assemble the,

47
00:02:51,236 --> 00:02:55,307
uh, the newsletter now. If the flow,

48
00:02:55,308 --> 00:02:58,931
if the image flows. It fails, there won't be a image in the newsletter,

49
00:02:58,932 --> 00:03:01,415
and it'll be obvious that there isn't an image.

50
00:03:01,416 --> 00:03:03,590
Um,

51
00:03:03,600 --> 00:03:08,425
of course, one way to solve this is to have a fallback image

52
00:03:08,902 --> 00:03:11,360
that isn't relevant,

53
00:03:11,361 --> 00:03:14,435
like. To have some kind of fallback image,

54
00:03:14,458 --> 00:03:17,356
I don't like that- I don't like that solution.

55
00:03:17,730 --> 00:03:22,121
So the reason that we decorate every single- every single story in newsletter issues

56
00:03:22,122 --> 00:03:26,417
is just to make sure that the flow actually- and then run the image

57
00:03:26,418 --> 00:03:30,207
flow every five minutes. it's it's just to make sure that if it does,

58
00:03:30,208 --> 00:03:32,674
um, if it does fail,

59
00:03:32,845 --> 00:03:35,238
that it will try, uh, uh, again,

60
00:03:35,239 --> 00:03:37,790
uh, because every time we pull this air table list,

61
00:03:37,898 --> 00:03:41,585
the list comes in randomized, so it's like, it'll start from a different story

62
00:03:41,842 --> 00:03:45,050
and kind of like work its way through and then- stop at the potentially

63
00:03:45,051 --> 00:03:48,413
the problematic story. Um,

64
00:03:48,424 --> 00:03:50,971
there has to be a better way to do this. I just haven't,

65
00:03:50,972 --> 00:03:53,780
uh, I haven't spent time trying to figure it out,

66
00:03:53,781 --> 00:03:58,342
but there's- there- there is a good way to create a robust flow where

67
00:03:58,343 --> 00:04:01,130
we only generate images for the s- stories that go out.

68
00:04:01,131 --> 00:04:04,397
Umm, probably by moving the assembled issues and stories,

69
00:04:04,398 --> 00:04:07,434
like determine what stories go in the newsletter earlier in the day.

70
00:04:07,703 --> 00:04:09,828
Right now it happens at 10 p.m.

71
00:04:09,829 --> 00:04:13,165
Eastern. I think if we moved it substantially earlier,

72
00:04:13,166 --> 00:04:15,740
umm, after all the news has come in, maybe around 6.

73
00:04:16,021 --> 00:04:18,684
Umm, then we could generate images between,

74
00:04:19,157 --> 00:04:21,490
you know, 6 and 7, give it an hour,

75
00:04:21,491 --> 00:04:24,773
uhh, just in case. Cause it's also generating images for,

76
00:04:24,774 --> 00:04:27,374
right now it's only generating images for 3 newsletters.

77
00:04:27,375 --> 00:04:30,247
So that's like 15 images. But in the future,

78
00:04:30,248 --> 00:04:33,059
if you add more newsletters, there could be . . Dozens of,

79
00:04:33,222 --> 00:04:36,232
you know, many dozens of stories that it's generating images for.

80
00:04:36,233 --> 00:04:38,268
Umm.

81
00:04:38,278 --> 00:04:42,787
Honestly, it probably requires separate, probably breaking apart the image flow so that

82
00:04:42,788 --> 00:04:48,011
if it does fail. Umm. Uhh.

83
00:04:48,012 --> 00:04:50,409
Yeah. Probably requires breaking it up.

84
00:04:50,410 --> 00:04:52,600
That's probably what, that's probably what I would do.

85
00:04:52,601 --> 00:04:57,284
To have like, you know, only 15 images per hour on one image

86
00:04:57,285 --> 00:04:59,904
flow. Anyway.

87
00:05:00,581 --> 00:05:02,689
The way that this works is, uh,

88
00:05:02,700 --> 00:05:06,040
pulls needs image so we- the determine that a newsletter needs an image.

89
00:05:15,391 --> 00:05:17,648
I think it's based on image status.

90
00:05:17,649 --> 00:05:20,256
us. Yeah,

91
00:05:20,309 --> 00:05:24,083
image status is pending. So if image status here is pending,

92
00:05:24,349 --> 00:05:28,762
and this is the default, um, so the default is pending here.

93
00:05:29,050 --> 00:05:31,299
So if the image, so when a new story comes in,

94
00:05:31,300 --> 00:05:33,410
the default image status is that it's pending.

95
00:05:34,635 --> 00:05:36,661
Once we've determined, you know, we get. Good. That list,

96
00:05:36,662 --> 00:05:38,947
uh, we run it through a sensitive words filter.

97
00:05:38,948 --> 00:05:41,213
It basically just tries to filter, um,

98
00:05:41,223 --> 00:05:44,432
sexual content out of the,

99
00:05:44,433 --> 00:05:48,120
like, we just filter throwaway stories that contain any of these words,

100
00:05:48,121 --> 00:05:50,451
basically. Um, and there's another, like,

101
00:05:50,532 --> 00:05:53,162
in any of these fields. field. Um,

102
00:05:53,173 --> 00:05:56,744
there's probably smarter logic to do this. You could use AI to do this.

103
00:05:56,745 --> 00:06:00,055
Um, I think that would actually probably be a good idea,

104
00:06:00,126 --> 00:06:02,414
because there's more than just sexual filter.

105
00:06:02,415 --> 00:06:04,722
It's just that with regards to,

106
00:06:04,723 --> 00:06:07,238
like, given our sources and the types of stories that we're pulling,

107
00:06:07,239 --> 00:06:10,015
I think that the sexual- words are actually probably the most,

108
00:06:10,016 --> 00:06:12,910
uh, likely thing to fail the image flow.

109
00:06:13,761 --> 00:06:16,001
And from a policy perspective, anyway.

110
00:06:17,086 --> 00:06:19,502
Then, uh, Gemini attempts to generate an image.

111
00:06:19,503 --> 00:06:22,305
Um, we all understand what this flow looks like.

112
00:06:22,306 --> 00:06:24,986
Um, this is just, this is path. That's design,

113
00:06:24,987 --> 00:06:27,145
actually. So, and, so I think,

114
00:06:27,146 --> 00:06:30,055
uh, you'll understand this, Pat. Um,

115
00:06:30,065 --> 00:06:32,533
Gemini attempts to generate an image. If there's an error,

116
00:06:32,534 --> 00:06:34,606
which sometimes there is, uh, like it,

117
00:06:34,607 --> 00:06:37,197
you know, there's a sensitive word that comes through or,

118
00:06:37,198 --> 00:06:40,011
um, uh,

119
00:06:37,234 --> 00:06:40,011
uh,

120
00:06:40,704 --> 00:06:42,798
there's a variety of reasons that the flow can fail.

121
00:06:42,799 --> 00:06:45,399
And if any of those occur, then they,

122
00:06:45,400 --> 00:06:48,826
eh, uh, we pass it to OpenAI using the same,

123
00:06:48,827 --> 00:06:51,619
uh, same node, uh, the same data.

124
00:06:51,620 --> 00:06:54,646
Uh, so you pass it to OpenAI to reduce the same data.

125
00:06:54,647 --> 00:06:57,961
Uh, Ahh. These are set fields,

126
00:06:57,962 --> 00:07:01,703
they just basically make sure that story ID persists so that we can line

127
00:07:01,704 --> 00:07:05,268
the images back up with the, um,

128
00:07:05,269 --> 00:07:08,538
uh, with the image. The, the articles to the image.

129
00:07:09,322 --> 00:07:12,005
When we do that with story ID. Because story ID is,

130
00:07:12,006 --> 00:07:16,381
This is again, like, that's the ID that we're using from the newsletter stories

131
00:07:16,382 --> 00:07:19,403
table onward. Convert to binary,

132
00:07:19,404 --> 00:07:21,775
this just makes sure this converts to, um,

133
00:07:21,785 --> 00:07:23,853
you know, from base 64 to binary.

134
00:07:23,854 --> 00:07:27,303
Um, and then we upload it to CloudFlare.

135
00:07:27,525 --> 00:07:29,823
When it, gets to CloudFlare,

136
00:07:29,824 --> 00:07:34,414
uh, the name of the image is being

137
00:07:34,548 --> 00:07:38,433
this node, makes the name of the image the story ID.

138
00:07:38,822 --> 00:07:41,420
So, all of, in CloudFlare,

139
00:07:41,421 --> 00:07:46,420
oh,

140
00:07:50,364 --> 00:07:52,943
actually. Actually,

141
00:08:00,011 --> 00:08:04,930
This

142
00:08:04,931 --> 00:08:07,249
is where our images live in CloudFlare.

143
00:08:07,696 --> 00:08:10,340
All of these images, this is a story ID.

144
00:08:10,787 --> 00:08:13,496
So, you can tell where these images go,

145
00:08:13,580 --> 00:08:16,011
just for QA purposes.

146
00:08:16,012 --> 00:08:18,569
By looking for the story ID.

147
00:08:18,570 --> 00:08:21,585
Umm, so this one belongs to Pivot Invest.

148
00:08:24,261 --> 00:08:26,526
Something about tulips. Anyway,

149
00:08:26,527 --> 00:08:29,559
so that is, this is where the images live.

150
00:08:29,560 --> 00:08:32,011
Uh, they live under hosted images and all the- Bye.

151
00:08:32,012 --> 00:08:35,135
The- the names of the images are the story IDs.

152
00:08:36,348 --> 00:08:39,963
Which makes it easier to QA. Umm,

153
00:08:39,973 --> 00:08:42,382
so that's what these set fields are, is just to make sure that it

154
00:08:42,383 --> 00:08:45,315
understands, uh, how to name the images.

155
00:08:46,336 --> 00:08:49,375
They images get uploaded to cloud. Uh,

156
00:08:49,386 --> 00:08:51,997
we make sure that the story ID and the image URL,

157
00:08:51,998 --> 00:08:56,255
um, persists. We create- this is how we create the image URL.

158
00:08:56,491 --> 00:08:59,101
The image URL is formulaic. So,

159
00:08:59,231 --> 00:09:01,463
it's this base URL.

160
00:09:01,464 --> 00:09:03,787
Uh, this is our account ID,

161
00:09:03,788 --> 00:09:06,457
right? Here. And then, result ID,

162
00:09:06,458 --> 00:09:08,650
this is the name of the image.

163
00:09:10,116 --> 00:09:14,020
So, we add that to the end of the URL string and then slash

164
00:09:14,021 --> 00:09:20,011
newsletter. Newsletter is the name of a transformation in,

165
00:09:20,012 --> 00:09:22,831
Umm, CloudFlare.

166
00:09:23,096 --> 00:09:25,532
So, this is newsletter. It's a variant.

167
00:09:25,533 --> 00:09:29,199
It's what they call it. So, instead of using Cloudinary to resize images,

168
00:09:29,200 --> 00:09:32,349
we're using CloudFlare. It's cheaper and easier,

169
00:09:32,350 --> 00:09:34,678
I think. Uhh,

170
00:09:34,689 --> 00:09:36,911
ChadGBT thinks. So,

171
00:09:37,370 --> 00:09:40,317
these are, this is width and height. So, this is how we want every

172
00:09:40,318 --> 00:09:42,534
single image to appear. This makes sure,

173
00:09:42,535 --> 00:09:44,570
you know, this is just our resizing capability.

174
00:09:44,571 --> 00:09:46,824
And this variant is called newsletter.

175
00:09:47,295 --> 00:09:51,430
So, if you change, there's another one called logo that we use to deliver

176
00:09:51,431 --> 00:09:55,656
the, Uh, pivot5, like the logo in the header.

177
00:09:57,202 --> 00:10:00,032
It's this logo. So, this is the,

178
00:10:00,033 --> 00:10:03,118
this uses the logo variant. Um,

179
00:10:03,129 --> 00:10:05,185
and so, anyway, that's what,

180
00:10:05,570 --> 00:10:08,011
that's what this is. Slap.

181
00:10:08,012 --> 00:10:12,342
This tells, uh, this, this, this,

182
00:10:12,633 --> 00:10:16,277
this, basically, if you call this URL with slash newsletter variant,

183
00:10:16,278 --> 00:10:18,329
it will make sure that it hits this,

184
00:10:18,330 --> 00:10:20,813
that this is the size. Um,

185
00:10:20,823 --> 00:10:25,524
and it has these characteristics. So once we have,

186
00:10:25,525 --> 00:10:28,317
so we've created the image URL, uhm,

187
00:10:28,328 --> 00:10:30,444
we have the story ID available,

188
00:10:30,445 --> 00:10:33,043
which we can use to match. Then we also pull an ID.

189
00:10:33,323 --> 00:10:35,985
I don't think I'm using ID, but we have it available.

190
00:10:37,480 --> 00:10:40,011
Upload the final image. So we.

191
00:10:39,847 --> 00:10:41,873
We use the story ID to match,

192
00:10:42,413 --> 00:10:44,871
which is just the name of the file.

193
00:10:44,872 --> 00:10:48,602
So we, we use the story ID, which persists because of the last set

194
00:10:48,603 --> 00:10:51,434
node, um, and then add the image URL.

195
00:10:51,932 --> 00:10:55,122
And then have the image status be updated to complete,

196
00:10:55,193 --> 00:10:57,332
because it's complete. If there is an error,

197
00:10:57,333 --> 00:10:59,571
it will create, uh, you know what I'll say,

198
00:10:59,572 --> 00:11:01,671
failed, right? This has not happened yet,

199
00:11:01,672 --> 00:11:05,348
actually, um, but it should work. Uh,

200
00:11:05,359 --> 00:11:08,514
yeah, and this one uses a record ID. Um,

201
00:11:08,525 --> 00:11:11,312
you could change this to using story ID, it shouldn't matter,

202
00:11:11,313 --> 00:11:14,605
but, Uh, right now it's just using the error table record ID.

203
00:11:17,283 --> 00:11:20,720
So that's how images work. Um,

204
00:11:20,730 --> 00:11:25,015
like I said, I think the big issue here is that we're probably spending

205
00:11:25,016 --> 00:11:28,011
too much money decorating every single,

206
00:11:28,012 --> 00:11:30,964
Every single story in newsletter stories,

207
00:11:30,965 --> 00:11:35,611
95% of which will never get used with an image for the sake of

208
00:11:35,612 --> 00:11:37,684
durability. It's, you know,

209
00:11:37,685 --> 00:11:39,801
it's more robust to do it like this.

210
00:11:39,874 --> 00:11:43,147
We are more assured that a newsletter is never going to go out without

211
00:11:43,148 --> 00:11:46,116
an image because, Because this runs every 20 minutes,

212
00:11:46,117 --> 00:11:50,374
and we know that it's just extremely unlikely that,

213
00:11:50,375 --> 00:11:54,153
um, you know, we're gonna have a piece of news that goes out that

214
00:11:54,154 --> 00:11:56,402
doesn't have a complete image.

215
00:11:56,840 --> 00:12:00,011
But also, to, you know, when we compile new,

216
00:12:00,012 --> 00:12:03,994
When we, when we determine of these stories,

217
00:12:04,118 --> 00:12:06,806
which are eligible to be compiled into a newsletter,

218
00:12:06,807 --> 00:12:09,281
we only pull by image status complete.

219
00:12:09,597 --> 00:12:12,791
So that's how we make 100% sure that we're never going to send out

220
00:12:12,792 --> 00:12:17,623
a newsletter without an image. Um. And I will go through that flow

221
00:12:17,671 --> 00:12:19,843
next. Um. But yeah,

222
00:12:19,844 --> 00:12:22,751
this is the, this is the image flow. And you can see this is

223
00:12:23,245 --> 00:12:26,244
the image URL. So this is what it looks like.

224
00:12:26,245 --> 00:12:31,268
Um, and this is based on this is the newsletter variant slash newsletter.

225
00:12:31,485 --> 00:12:35,148
We know. But that it is using the newsletter variant and it's going to

226
00:12:35,149 --> 00:12:37,604
be exactly the size. So it fits well into our newsletter.

227
00:12:39,052 --> 00:12:39,415
Okay. Thank much.
